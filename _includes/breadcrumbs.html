{%- if page.url != "/" -%}
<div id="breadcrumbs" style="margin-bottom: 2%;">
  <a href="/">Startseite</a>
  {%- assign breadcrumbs = page.url | remove:'/index.html' | remove_first:'/' | split:'/' -%}
  {%- assign path = "" -%}
 
  {%- for crumb in breadcrumbs -%}
    {%- assign path = path | append:'/' | append:crumb -%}
    {%- assign path_slash = path | append:'/' -%}
    {%- assign path_html = path | append:'.html' -%}
    {%- assign matched = nil -%}
    {%- assign matched = site.pages | where: "url", path_slash | first -%}
    {%- if matched == nil -%}
      {%- assign matched = site.pages | where: "url", path_html | first -%}
    {%- endif -%}
    {%- if matched == nil -%}
      {%- assign matched = site.pages | where: "url", path | first -%}
    {%- endif -%}
    {%- if matched == nil -%}
      {%- assign matched = site.pages | where: "permalink", path_slash | first -%}
    {%- endif -%}
    {%- if matched == nil -%}
      {%- assign matched = site.pages | where: "permalink", path | first -%}
    {%- endif -%}
    
    {%- if matched == nil -%}
      {%- for p in site.pages -%}
        {%- if p.permalink -%}
          {%- assign perm_slash = p.permalink | append: '/' -%}
          {%- if perm_slash == path_slash or p.permalink == path -%}
            {%- assign matched = p -%}
            {%- break -%}
          {%- endif -%}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}

    {%- assign crumb_url = path -%}

    {%- if matched -%}
      {%- if matched.permalink -%}
        {%- assign crumb_url = matched.permalink -%}
      {%- else -%}
        {%- assign crumb_url = matched.url -%}
      {%- endif -%}
    {%- endif -%}
 
    {%- if forloop.last -%}
      &nbsp;→ {{ page.title }}
    {%- else -%}
      &nbsp;→ <a href="{{ crumb_url }}">
        {%- if matched and matched.title -%}
          {{ matched.title }}
        {%- else -%}
          {%- capture crumb_text -%}{{ crumb | replace:'-',' ' | remove:'.html' }}{%- endcapture -%}
          {%- assign breadcrumb_words = crumb_text | split: ' ' -%}
          {%- for filter_word in breadcrumb_words -%}
            {%- if forloop.first -%}
              {{ filter_word | capitalize }}
            {%- else -%}
              {%- if
                filter_word == 'der' or
                filter_word == 'die' or
                filter_word == 'das' or
                filter_word == 'dem' or
                filter_word == 'den' or
                filter_word == 'des' or
                filter_word == 'und' or
                filter_word == 'oder' or
                filter_word == 'an' or
                filter_word == 'am' or
                filter_word == 'um' or
                filter_word == 'für' or
                filter_word == 'von' or
                filter_word == 'bis' or
                filter_word == 'gestellte' -%}
                  {{ filter_word }}
              {%- else -%}
                  {{ filter_word | capitalize }}
              {%- endif -%}
            {%- endif -%}
            {%- unless forloop.last -%} {{ ' ' }}{%- endunless -%}
          {%- endfor -%}
        {%- endif -%}
      </a>
    {%- endif -%}
  {%- endfor -%}
</div>
{%- endif -%}